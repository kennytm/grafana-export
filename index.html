<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="stylesheet" href="docs/bootstrap.min.css" />
<link rel="icon" href="docs/favicon.ico" />

<title>PingCAP MetricsTool</title>

<style>
    ol > li {
        padding-top: 2rem;
    }
    ol > li::marker {
        font-weight: bold;
    }
    pre {
        background: #eee;
        padding: 0.5rem;
    }
    @keyframes fade-out {
        50% { opacity: 1; }
        to { opacity: 0; }
    }
    #copied-note {
        animation: fade-out 1s forwards;
    }
    hr {
        margin-top: 20rem;
    }

    [lang] {
        display: none;
    }

    p[lang=en-US] {
        display: block;
    }
    span[lang=en-US] {
        display: inline;
    }
    textarea[lang=en-US] {
        display: block;
    }

    #title-screen, .bg-title-screen {
        background: #e9ecef;
    }
    #title-screen a {
        background: #fff;
        color: #344;
        display: block;
        border-radius: 6px;
        box-shadow: 0 1.5rem 1.5rem -1.25rem rgba(10,10,10,.05);
        transition: box-shadow .2s linear, transform .2s linear;
        height: 9rem;
    }
    #title-screen a:hover {
        text-decoration: none;
        transform: translateY(-.1rem);
        box-shadow: 0 2rem 2rem -1.25rem rgba(10,10,10,.1);
    }
</style>

</head>
<body>
<nav class="navbar navbar-expand navbar-light bg-title-screen fixed-top">
    <div class="navbar-collapse collapse">
        <a class="navbar-brand mr-auto" href="#">
            <img src="docs/icon.svg" width="24" height="24" alt="icon" />
            PingCAP MetricsTool
        </a>
        <form class="form-inline">
            <select class="form-control" id="lang-selector" disabled>
                <option value="en-US" selected>English</option>
                <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
                <option value="zh-TW">ç¹é«”ä¸­æ–‡</option>
            </select>
        </form>
    </div>
</nav>

<main>
    <div class="container-fluid">
        <div id="title-screen" class="row vh-100 align-items-center justify-content-center">
            <a class="col-sm-11 col-md-3 mx-3 p-4" href="#backup-with-dev-tools">
                <h4>
                    <span lang="en-US">Export</span>
                    <span lang="zh-CN">å¯¼å‡º</span>
                    <span lang="zh-TW">åŒ¯å‡º</span>
                </h4>
                <p class="text-muted">
                    <span lang="en-US">Export Grafana data as snapshot</span>
                    <span lang="zh-CN">å¯¼å‡º Grafana ç›‘æ§æ•°æ®ä¸ºå¿«ç…§</span>
                    <span lang="zh-TW">åŒ¯å‡º Grafana å„€è¡¨æ¿è³‡æ–™ç‚ºå¿«ç…§</span>
                </p>
            </a>
            <a class="col-sm-11 col-md-3 mx-3 p-4" href="./viz/index.html" target="_blank">
                <h4>
                    <span lang="en-US">View</span>
                    <span lang="zh-CN">æŸ¥çœ‹</span>
                    <span lang="zh-TW">æª¢è¦–</span>
                </h4>
                <p class="text-muted">
                    <span lang="en-US">View Grafana snapshot online</span>
                    <span lang="zh-CN">åœ¨çº¿æŸ¥çœ‹ Grafana å¿«ç…§</span>
                    <span lang="zh-TW">ç·šä¸Šæª¢è¦– Grafana å¿«ç…§</span>
                    ğŸ¡µ
                </p>
            </a>
            <a class="col-sm-11 col-md-3 mx-3 p-4" href="#restore-with-curl">
                <h4>
                    <span lang="en-US">Import</span>
                    <span lang="zh-CN">å¯¼å…¥</span>
                    <span lang="zh-TW">åŒ¯å…¥</span>
                </h4>
                <p class="text-muted">
                    <span lang="en-US">Import snapshot into local Grafana</span>
                    <span lang="zh-CN">å°†å¿«ç…§å¯¼å…¥åˆ°æœ¬åœ° Grafana</span>
                    <span lang="zh-TW">å°‡å¿«ç…§åŒ¯å…¥åˆ°æœ¬åœ° Grafana</span>
                </p>
            </a>
        </div>
    </div>

    <hr>

    <div class="p-5" id="backup-with-dev-tools">
        <h1>
            <span lang="en-US">Export Snapshot from Grafana Dashboard UI</span>
            <span lang="zh-CN">åœ¨ Grafana ç•Œé¢ä¸Šå¯¼å‡º</span>
            <span lang="zh-TW">å¾ Grafana ä»‹é¢ä¸ŠåŒ¯å‡º</span>
        </h1>
        <p lang="en-US">Supported on Chrome, Edge and Firefox browsers, requires Grafana v6.0+</p>
        <p lang="zh-CN">é€‚ç”¨äº Chrome / Edge / Firefox æµè§ˆå™¨ï¼Œè¦æ±‚ Grafana v6.0 æˆ–ä»¥ä¸Š</p>
        <p lang="zh-TW">é©ç”¨æ–¼ Chrome / Edge / Firefox ç€è¦½å™¨ï¼Œè¦æ±‚ Grafana v6.0 æˆ–ä»¥ä¸Š</p>
        <ol>
            <li>
                <p>
                    <button type="button" class="btn btn-outline-primary" id="copy-script-button">
                        <span lang="en-US">Copy the script below</span>
                        <span lang="zh-CN">å¤åˆ¶ä»¥ä¸‹è„šæœ¬</span>
                        <span lang="zh-TW">è¤‡è£½ä»¥ä¸‹æŒ‡ä»¤ç¢¼</span>
                    </button>
                    <em id="copied-note" style="display:none;">
                        <span lang="en-US">Copied!</span>
                        <span lang="zh-CN">å·²å¤åˆ¶ï¼</span>
                        <span lang="zh-TW">å·²è¤‡è£½ï¼</span>
                    </em>
                </p>
                <p class="w-100" id="script-container">
                    <textarea lang="en-US" class="w-100" readonly rows="3" cols="100">/* Copyright 2020 PingCAP, Inc. Licensed under MIT. */
&quot;use strict&quot;
var t={t:&quot;Script failed to run. Please ensure it is running on the Grafana v6.x.x dashboard page.&quot;,
i:&quot;Going to export snapshot of the current dashboard: &quot;,s:&quot;Note: Only metrics from visible panels can be exported&quot;,
o:&quot;Number of panels&quot;,l:&quot;Loading panels&quot;,h:&quot;Expand all rows&quot;,p:&quot;Export&quot;,u:&quot;Export immediately&quot;,cancel:&quot;Cancel&quot;}
try{
var e=angular.element,i=document.styleSheets[0],n=[&quot;.__dexport_hint{z-index:2222;position:fixed;background:#fff;color:#000;padding:1em;font-size:18px;border-left:3px solid #faad14;right:0;top:5em;opacity:.8;min-width:30em}&quot;,&quot;.__dexport_hint:hover{opacity:1}&quot;,&quot;.__dexport_hint button{margin:0 1em}&quot;,&quot;.__dexport_hint button[disabled]{opacity:.5}&quot;,&quot;.__dexport_hint progress{margin-right:1em;vertical-align:middle;width:18em}&quot;]
new(function(){function s(){var s=this,a=e(document).injector()
this.m=a.get(&quot;timeSrv&quot;)
var o=this.m.dashboard
n.forEach(t=&gt;i.insertRule(t,0)),this.v=e(&quot;&lt;span&gt;&quot;),this.g=e(&#39;&lt;progress value=&quot;0&quot;&gt;&#39;),
this._=e(&#39;&lt;button style=&quot;font-weight:bold&quot;&gt;&#39;).text(t.p).one(&quot;click&quot;,()=&gt;s.k()),
this.P=e(&quot;&lt;button&gt;&quot;).text(t.h).on(&quot;click&quot;,()=&gt;o.expandRows())
var r=/^(Mac|iP)/.test(navigator.platform)?&quot;flex-direction:row-reverse&quot;:&quot;justify-content:center&quot;
this.S=e(&#39;&lt;div class=&quot;__dexport_hint&quot;&gt;&#39;).append(e(&quot;&lt;p&gt;&quot;).text(t.i).append(e(&quot;&lt;strong&gt;&quot;).text(o.title)),e(&quot;&lt;p&gt;&quot;).text(t.s).append(this.P),e(&#39;&lt;p style=&quot;font-size:.8em&quot;&gt;&#39;).append(this.g,this.v),e(&#39;&lt;p style=&quot;display:flex;&#39;+r+&#39;&quot;&gt;&#39;).append(this._,e(&quot;&lt;button&gt;&quot;).text(t.cancel).on(&quot;click&quot;,()=&gt;s.j()))),
this.I=0,e(document.body).append(this.S),this.L=setInterval(()=&gt;s.N(),500)}return s.prototype.N=function(){
var i=this,n=e(&quot;.panel-container&quot;),s=n.length
if(0===this.I)this.v.text(t.o+&quot;: &quot;+s),this._.prop(&quot;disabled&quot;,0===s)
else{var a=s-n.find(&quot;.panel-loading:visible&quot;).length,o=(100*a/s||0).toFixed(1)
this.v.text(t.l+&quot;: &quot;+o+&quot;% (&quot;+a+&quot;/&quot;+s+&quot;)&quot;),this.g.prop({value:a,max:s}),s&gt;a?2!==this.I&amp;&amp;(this.I=2,
this._.prop(&quot;disabled&quot;,!1).text(t.u).one(&quot;click&quot;,()=&gt;i.O())):this.O()}},s.prototype.k=function(){var t=this.m.dashboard
this.I=1,this._.prop(&quot;disabled&quot;,!0),this.T=t.refresh,this.m.setAutoRefresh(),e(&quot;.panel-loading&quot;).removeClass(&quot;ng-hide&quot;),
t.snapshot={timestamp:new Date},t.startRefresh()},s.prototype.O=function(){
var t=this.m.dashboard,i=t.snapshot.timestamp.toISOString(),n=t.getSaveModelClone(),s=n.title
n.time=this.m.timeRange(),n.id=null,n.uid=null,n.title=s+&quot; (exported at &quot;+i+&quot;)&quot;
var a={meta:{isSnapshot:!0,type:&quot;snapshot&quot;,expires:&quot;9999-12-31T23:59:59Z&quot;,created:i},dashboard:n,overwrite:!0}
this.j()
var o=new Blob([JSON.stringify(a)],{type:&quot;application/json&quot;}),r=URL.createObjectURL(o),l=e(&quot;&lt;a&gt;&quot;)
l.prop({href:r,download:s+&quot;_&quot;+i+&quot;.json&quot;}),e(document.body).append(l),l[0].click(),setTimeout(()=&gt;{
URL.revokeObjectURL(r),l.remove()},0)},s.prototype.j=function(){var t=this.m.dashboard
delete t.snapshot,t.forEachPanel(t=&gt;delete t.snapshotData),t.annotations.list.forEach(t=&gt;delete t.snapshotData),
this.T&amp;&amp;this.m.setAutoRefresh(this.T),clearInterval(this.L),this.S.remove(),n.forEach(()=&gt;i.deleteRule(0))},s}())
}catch(e){console.error(e),alert(t.t)}</textarea>
                    <textarea lang="zh-CN" class="w-100" readonly rows="3" cols="100">/* Copyright 2020 PingCAP, Inc. Licensed under MIT. */
&quot;use strict&quot;
var t={t:&quot;æ‰§è¡Œå¤±è´¥ã€‚è¯·ç¡®ä¿æ˜¯åœ¨ Grafana v6.x.x çš„ç›‘æ§ç½‘é¡µä¸Šæ‰§è¡Œè„šæœ¬ã€‚&quot;,i:&quot;å°†å¯¼å‡ºå½“å‰çš„ç›‘æ§é¡µé¢ï¼š&quot;,s:&quot;æ³¨æ„ï¼šåªæœ‰å·²å±•å¼€é¢æ¿å†…çš„ç›‘æ§ä¼šè¢«å¯¼å‡º&quot;,o:&quot;é¢æ¿æ•°é‡&quot;,h:&quot;åŠ è½½é¢æ¿ä¸­&quot;,l:&quot;å±•å¼€æ‰€æœ‰é¢æ¿&quot;,
p:&quot;å¯¼å‡º&quot;,u:&quot;ç«‹åˆ»å¯¼å‡º&quot;,cancel:&quot;å–æ¶ˆ&quot;}
try{
var i=angular.element,e=document.styleSheets[0],s=[&quot;.__dexport_hint{z-index:2222;position:fixed;background:#fff;color:#000;padding:1em;font-size:18px;border-left:3px solid #faad14;right:0;top:5em;opacity:.8;min-width:30em}&quot;,&quot;.__dexport_hint:hover{opacity:1}&quot;,&quot;.__dexport_hint button{margin:0 1em}&quot;,&quot;.__dexport_hint button[disabled]{opacity:.5}&quot;,&quot;.__dexport_hint progress{margin-right:1em;vertical-align:middle;width:18em}&quot;]
new(function(){function n(){var n=this,a=i(document).injector()
this.v=a.get(&quot;timeSrv&quot;)
var o=this.v.dashboard
s.forEach(t=&gt;e.insertRule(t,0)),this.m=i(&quot;&lt;span&gt;&quot;),this._=i(&#39;&lt;progress value=&quot;0&quot;&gt;&#39;),
this.g=i(&#39;&lt;button style=&quot;font-weight:bold&quot;&gt;&#39;).text(t.p).one(&quot;click&quot;,()=&gt;n.k()),
this.P=i(&quot;&lt;button&gt;&quot;).text(t.l).on(&quot;click&quot;,()=&gt;o.expandRows())
var r=/^(Mac|iP)/.test(navigator.platform)?&quot;flex-direction:row-reverse&quot;:&quot;justify-content:center&quot;
this.S=i(&#39;&lt;div class=&quot;__dexport_hint&quot;&gt;&#39;).append(i(&quot;&lt;p&gt;&quot;).text(t.i).append(i(&quot;&lt;strong&gt;&quot;).text(o.title)),i(&quot;&lt;p&gt;&quot;).text(t.s).append(this.P),i(&#39;&lt;p style=&quot;font-size:.8em&quot;&gt;&#39;).append(this._,this.m),i(&#39;&lt;p style=&quot;display:flex;&#39;+r+&#39;&quot;&gt;&#39;).append(this.g,i(&quot;&lt;button&gt;&quot;).text(t.cancel).on(&quot;click&quot;,()=&gt;n.j()))),
this.I=0,i(document.body).append(this.S),this.T=setInterval(()=&gt;n.L(),500)}return n.prototype.L=function(){
var e=this,s=i(&quot;.panel-container&quot;),n=s.length
if(0===this.I)this.m.text(t.o+&quot;: &quot;+n),this.g.prop(&quot;disabled&quot;,0===n)
else{var a=n-s.find(&quot;.panel-loading:visible&quot;).length,o=(100*a/n||0).toFixed(1)
this.m.text(t.h+&quot;: &quot;+o+&quot;% (&quot;+a+&quot;/&quot;+n+&quot;)&quot;),this._.prop({value:a,max:n}),n&gt;a?2!==this.I&amp;&amp;(this.I=2,
this.g.prop(&quot;disabled&quot;,!1).text(t.u).one(&quot;click&quot;,()=&gt;e.O())):this.O()}},n.prototype.k=function(){var t=this.v.dashboard
this.I=1,this.g.prop(&quot;disabled&quot;,!0),this.R=t.refresh,this.v.setAutoRefresh(),i(&quot;.panel-loading&quot;).removeClass(&quot;ng-hide&quot;),
t.snapshot={timestamp:new Date},t.startRefresh()},n.prototype.O=function(){
var t=this.v.dashboard,e=t.snapshot.timestamp.toISOString(),s=t.getSaveModelClone(),n=s.title
s.time=this.v.timeRange(),s.id=null,s.uid=null,s.title=n+&quot; (exported at &quot;+e+&quot;)&quot;
var a={meta:{isSnapshot:!0,type:&quot;snapshot&quot;,expires:&quot;9999-12-31T23:59:59Z&quot;,created:e},dashboard:s,overwrite:!0}
this.j()
var o=new Blob([JSON.stringify(a)],{type:&quot;application/json&quot;}),r=URL.createObjectURL(o),h=i(&quot;&lt;a&gt;&quot;)
h.prop({href:r,download:n+&quot;_&quot;+e+&quot;.json&quot;}),i(document.body).append(h),h[0].click(),setTimeout(()=&gt;{
URL.revokeObjectURL(r),h.remove()},0)},n.prototype.j=function(){var t=this.v.dashboard
delete t.snapshot,t.forEachPanel(t=&gt;delete t.snapshotData),t.annotations.list.forEach(t=&gt;delete t.snapshotData),
this.R&amp;&amp;this.v.setAutoRefresh(this.R),clearInterval(this.T),this.S.remove(),s.forEach(()=&gt;e.deleteRule(0))},n}())
}catch(i){console.error(i),alert(t.t)}</textarea>
                    <textarea lang="zh-TW" class="w-100" readonly rows="3" cols="100">/* Copyright 2020 PingCAP, Inc. Licensed under MIT. */
&quot;use strict&quot;
var t={t:&quot;åŸ·è¡Œå¤±æ•—ã€‚è«‹ç¢ºä¿æ˜¯åœ¨ Grafana v6.x.x çš„å„€è¡¨æ¿ä¸ŠåŸ·è¡ŒåŠ‡æœ¬ã€‚&quot;,i:&quot;å³å°‡åŒ¯å‡ºç•¶å‰å„€è¡¨æ¿ï¼š&quot;,s:&quot;æ³¨æ„ï¼šåªèƒ½åŒ¯å‡ºå·²å±•é–‹çš„é¢æ¿å…§çš„è³‡æ–™&quot;,o:&quot;é¢æ¿æ•¸é‡&quot;,h:&quot;è¼‰å…¥é¢æ¿ä¸­&quot;,l:&quot;å±•é–‹æ‰€æœ‰é¢æ¿&quot;,
p:&quot;åŒ¯å‡º&quot;,u:&quot;ç«‹å³åŒ¯å‡º&quot;,cancel:&quot;å–æ¶ˆ&quot;}
try{
var i=angular.element,e=document.styleSheets[0],s=[&quot;.__dexport_hint{z-index:2222;position:fixed;background:#fff;color:#000;padding:1em;font-size:18px;border-left:3px solid #faad14;right:0;top:5em;opacity:.8;min-width:30em}&quot;,&quot;.__dexport_hint:hover{opacity:1}&quot;,&quot;.__dexport_hint button{margin:0 1em}&quot;,&quot;.__dexport_hint button[disabled]{opacity:.5}&quot;,&quot;.__dexport_hint progress{margin-right:1em;vertical-align:middle;width:18em}&quot;]
new(function(){function n(){var n=this,a=i(document).injector()
this.v=a.get(&quot;timeSrv&quot;)
var o=this.v.dashboard
s.forEach(t=&gt;e.insertRule(t,0)),this.m=i(&quot;&lt;span&gt;&quot;),this._=i(&#39;&lt;progress value=&quot;0&quot;&gt;&#39;),
this.g=i(&#39;&lt;button style=&quot;font-weight:bold&quot;&gt;&#39;).text(t.p).one(&quot;click&quot;,()=&gt;n.k()),
this.P=i(&quot;&lt;button&gt;&quot;).text(t.l).on(&quot;click&quot;,()=&gt;o.expandRows())
var r=/^(Mac|iP)/.test(navigator.platform)?&quot;flex-direction:row-reverse&quot;:&quot;justify-content:center&quot;
this.S=i(&#39;&lt;div class=&quot;__dexport_hint&quot;&gt;&#39;).append(i(&quot;&lt;p&gt;&quot;).text(t.i).append(i(&quot;&lt;strong&gt;&quot;).text(o.title)),i(&quot;&lt;p&gt;&quot;).text(t.s).append(this.P),i(&#39;&lt;p style=&quot;font-size:.8em&quot;&gt;&#39;).append(this._,this.m),i(&#39;&lt;p style=&quot;display:flex;&#39;+r+&#39;&quot;&gt;&#39;).append(this.g,i(&quot;&lt;button&gt;&quot;).text(t.cancel).on(&quot;click&quot;,()=&gt;n.j()))),
this.I=0,i(document.body).append(this.S),this.T=setInterval(()=&gt;n.L(),500)}return n.prototype.L=function(){
var e=this,s=i(&quot;.panel-container&quot;),n=s.length
if(0===this.I)this.m.text(t.o+&quot;: &quot;+n),this.g.prop(&quot;disabled&quot;,0===n)
else{var a=n-s.find(&quot;.panel-loading:visible&quot;).length,o=(100*a/n||0).toFixed(1)
this.m.text(t.h+&quot;: &quot;+o+&quot;% (&quot;+a+&quot;/&quot;+n+&quot;)&quot;),this._.prop({value:a,max:n}),n&gt;a?2!==this.I&amp;&amp;(this.I=2,
this.g.prop(&quot;disabled&quot;,!1).text(t.u).one(&quot;click&quot;,()=&gt;e.O())):this.O()}},n.prototype.k=function(){var t=this.v.dashboard
this.I=1,this.g.prop(&quot;disabled&quot;,!0),this.R=t.refresh,this.v.setAutoRefresh(),i(&quot;.panel-loading&quot;).removeClass(&quot;ng-hide&quot;),
t.snapshot={timestamp:new Date},t.startRefresh()},n.prototype.O=function(){
var t=this.v.dashboard,e=t.snapshot.timestamp.toISOString(),s=t.getSaveModelClone(),n=s.title
s.time=this.v.timeRange(),s.id=null,s.uid=null,s.title=n+&quot; (exported at &quot;+e+&quot;)&quot;
var a={meta:{isSnapshot:!0,type:&quot;snapshot&quot;,expires:&quot;9999-12-31T23:59:59Z&quot;,created:e},dashboard:s,overwrite:!0}
this.j()
var o=new Blob([JSON.stringify(a)],{type:&quot;application/json&quot;}),r=URL.createObjectURL(o),h=i(&quot;&lt;a&gt;&quot;)
h.prop({href:r,download:n+&quot;_&quot;+e+&quot;.json&quot;}),i(document.body).append(h),h[0].click(),setTimeout(()=&gt;{
URL.revokeObjectURL(r),h.remove()},0)},n.prototype.j=function(){var t=this.v.dashboard
delete t.snapshot,t.forEachPanel(t=&gt;delete t.snapshotData),t.annotations.list.forEach(t=&gt;delete t.snapshotData),
this.R&amp;&amp;this.v.setAutoRefresh(this.R),clearInterval(this.T),this.S.remove(),s.forEach(()=&gt;e.deleteRule(0))},n}())
}catch(i){console.error(i),alert(t.t)}</textarea>
                </p>
            </li>
            <li>
                <p lang="en-US">After opening a Grafana Dashboard, press <kbd>F12</kbd> the launch the Developer Tool, and then paste the script in the â€œConsoleâ€ tab.</p>
                <p lang="zh-CN">åœ¨ Grafana ç›‘æ§é¢æ¿ä¸­æŒ‰ä¸‹ <kbd>F12</kbd> å¯åŠ¨å¼€å‘è€…å·¥å…·ï¼Œåœ¨ â€œConsoleâ€ é¢æ¿ä¸‹ç²˜è´´è„šæœ¬ã€‚</p>
                <p lang="zh-TW">åœ¨ Grafana å„€è¡¨æ¿ä¸­æŒ‰ä¸‹ <kbd>F12</kbd> å•Ÿå‹•é–‹ç™¼è€…å·¥å…·ï¼Œåœ¨ã€ŒConsoleã€é ä¸‹è²¼ä¸ŠæŒ‡ä»¤ç¢¼ã€‚</p>
                <p><img src="docs/dev-tools-5.png" class="img-fluid" width="420" height="210" alt="Pasting the script into the Developer Tool Console"></p>
            </li>
            <li>
                <p lang="en-US">Press <kbd>Enter</kbd> to execute the script. A dialog should now appear on the web page. Follow its instruction to continue.</p>
                <p lang="zh-CN">æŒ‰ä¸‹ <kbd>å›è½¦ (Enter)</kbd> æ‰§è¡Œè„šæœ¬ã€‚æ­¤æ—¶ Grafana ç½‘é¡µä¸­ä¼šå‡ºç°æ“ä½œæç¤ºæ¡†ï¼Œè¯·éµå¾ªå…¶æŒ‡ç¤ºè¿›è¡Œåç»­æ“ä½œã€‚</p>
                <p lang="zh-TW">æŒ‰ä¸‹ <kbd>è¼¸å…¥ (Enter)</kbd> é‹è¡ŒæŒ‡ä»¤ç¢¼ã€‚æ­¤æ™‚ Grafana ç¶²é¢ä¸­æœƒå‡ºç¾æ“ä½œæç¤ºæ¡†ï¼Œè«‹éµå¾ªå…¶æŒ‡ç¤ºç¹¼çºŒæ“ä½œã€‚</p>
                <p><img src="docs/dev-tools-6.png" class="img-fluid" width="337" height="135" alt="The dialog in the Dashboard"></p>
            </li>
        </ol>
        <p><a href="#">â†‘
            <span lang="en-US">Return</span>
            <span lang="zh-CN">è¿”å›</span>
            <span lang="zh-TW">è¿”å›</span>
        </a> &nbsp; // &nbsp; <a href="#backup-with-manual">â†“
            <span lang="en-US">Extract Local Snapshot</span>
            <span lang="zh-CN">æ‰‹åŠ¨å–å‡ºæœ¬åœ°å¿«ç…§</span>
            <span lang="zh-TW">æ‰‹å‹•å–å‡ºæœ¬åœ°å¿«ç…§</span>
        </a></p>
    </div>

    <hr>

    <div class="p-5" id="backup-with-manual">
        <h1>
            <span lang="en-US">Extract Local Snapshot</span>
            <span lang="zh-CN">æ‰‹åŠ¨å–å‡ºæœ¬åœ°å¿«ç…§</span>
            <span lang="zh-TW">æ‰‹å‹•å–å‡ºæœ¬åœ°å¿«ç…§</span>
        </h1>
        <p lang="en-US">Suitable when the browser or Grafana version is too old</p>
        <p lang="zh-CN">æµè§ˆå™¨æˆ– Grafana ç‰ˆæœ¬å¤ªä½æ—¶é€‚ç”¨</p>
        <p lang="zh-TW">ç€è¦½å™¨æˆ– Grafana ç‰ˆæœ¬å¤ªä½æ™‚é©ç”¨</p>
        <ol>
            <li>
                <p lang="en-US">After opening a Grafana Dashboard, expand rows which need to exported, or press <kbd>d</kbd> then <kbd>Shift</kbd>+<kbd>E</kbd> to expand all rows (only visible panels are exported).</p>
                <p lang="zh-CN">åœ¨ Grafana ç›‘æ§ä¸­å±•å¼€éœ€è¦æ±‡å‡ºçš„é¢æ¿ï¼Œæˆ–æŒ‰ <kbd>d</kbd> ç„¶å <kbd>Shift</kbd>+<kbd>E</kbd> å±•å¼€æ‰€æœ‰é¢æ¿ï¼ˆåªæœ‰æ˜¾ç¤ºçš„é¢æ¿æ‰ä¼šè¢«ä¿å­˜ï¼‰ã€‚</p>
                <p lang="zh-TW">åœ¨ Grafana å„€è¡¨æ¿ä¸­å±•é–‹éœ€è¦åŒ¯å‡ºçš„é¢æ¿ï¼Œæˆ–æŒ‰ <kbd>d</kbd> ç„¶å¾Œ <kbd>Shift</kbd>+<kbd>E</kbd> å±•é–‹æ‰€æœ‰é¢æ¿ï¼ˆåªæœ‰é¡¯ç¤ºçš„é¢æ¿æ‰æœƒè¢«å„²å­˜ï¼‰ã€‚</p>
            </li>
            <li>
                <p lang="en-US">Click the â€œShare dashboardâ€ button in the toolbar, then â€œSnapshotâ€, and finally â€œLocal snapshotâ€.</p>
                <p lang="zh-CN">ç‚¹å‡»å·¥å…·åˆ—ä¸­çš„ â€œShare dashboardâ€ æŒ‰é’®ï¼Œç„¶åé€‰ â€œSnapshotâ€ï¼Œæœ€åç‚¹ â€œLocal snapshotâ€ æŒ‰é’®ã€‚</p>
                <p lang="zh-TW">é»ä¸€ä¸‹å·¥å…·æ¬„ä¸­çš„ã€ŒShare dashboardã€æŒ‰éˆ•ï¼Œç„¶å¾Œé¸ã€ŒSnapshotã€ï¼Œæœ€å¾Œé»ä¸€ä¸‹ã€ŒLocal snapshotã€æŒ‰éˆ•ã€‚</p>
                <p><img src="docs/manual-1.png" class="img-fluid" width="398" height="119" alt="â€œShare dashboardâ€ button"></p>
            </li>
            <li>
                <label for="manual-url-field">
                    <span lang="en-US">Paste the snapshot link here:</span>
                    <span lang="zh-CN">å®ŒæˆåæŠŠåˆšå‡ºç°çš„å¿«å–è¿æ¥è´´åˆ°è¿™é‡Œï¼š</span>
                    <span lang="zh-TW">å®Œæˆå¾ŒæŠŠå‰›å‡ºç¾çš„å¿«å–é€£çµè²¼åˆ°é€™è£¡ï¼š</span>
                </label>
                <input id="manual-url-field" type="url" size="80" placeholder="http://localhost:3000/dashboard/snapshot/sNaPsHoTIdEnTiFiEr">
            </li>
            <li>
                <span lang="en-US">Right click and save this link:</span>
                <span lang="zh-CN">å³é”®ä¿å­˜è¿™ä¸ªè¿æ¥ï¼š</span>
                <span lang="zh-TW">å³éµå„²å­˜é€™å€‹é€£çµï¼š</span>
                <a id="manual-url-link"></a>
                <em id="manual-url-invalid">
                    ğŸ’¡
                    <span lang="en-US">Paste the snapshot link to above first</span>
                    <span lang="zh-CN">è¯·å…ˆæŠŠå¿«å–è¿æ¥è´´åˆ°ä¸Šé¢</span>
                    <span lang="zh-TW">è«‹å…ˆæŠŠå¿«å–é€£çµè²¼åˆ°ä¸Šé¢</span>
                </em>
            </li>
        </ol>

        <p><a href="#">â†‘
            <span lang="en-US">Return</span>
            <span lang="zh-CN">è¿”å›</span>
            <span lang="zh-TW">è¿”å›</span>
        </a></p>
    </div>

    <!--
    <hr>

    <div class="p-5" id="viz">
        <h1>
            <span lang="en-US">Visualize Snapshot File on Web Page</span>
            <span lang="zh-CN">åœ¨ç½‘é¡µä¸Šæ£€è§†å¿«ç…§æ–‡ä»¶</span>
            <span lang="zh-TW">åœ¨ç¶²é ä¸Šæª¢è¦–å¿«ç…§æª”æ¡ˆ</span>
        </h1>

        <ol>
            <li>
                <p>
                    <span lang="en-US">Open</span>
                    <span lang="zh-CN">æ‰“å¼€</span>
                    <span lang="zh-TW">é–‹å•Ÿ</span>
                    <a href="https://metricstool.pingcap.com/viz/">https://metricstool.pingcap.com/viz/</a>.
                </p>
            </li>
            <li>
                <p lang="en-US">Click â€œOpen snapshotâ€ and choose the exported Snapshot File to visualize.</p>
                <p lang="zh-CN">ç‚¹é€‰ â€œOpen snapshotâ€ æ‰“å¼€è¦æ£€è§†çš„å¿«ç…§æ–‡ä»¶ã€‚</p>
                <p lang="zh-TW">é»é¸ã€ŒOpen snapshotã€é–‹å•Ÿè¦æª¢è¦–çš„å¿«ç…§æª”æ¡ˆã€‚</p>
                <p><img src="docs/viz.png" class="img-fluid" alt="Visualized graph"></p>
            </li>
        </ol>

        <p class="text-muted">
            <span lang="en-US">The snapshot is rendered entirely on client side. Nothing will be sent to PingCAP.</span>
            <span lang="zh-CN">å¿«ç…§æ–‡ä»¶å®Œå…¨æ˜¯åœ¨å®¢æˆ¶ç«¯å¤„ç†ï¼Œå…¶å†…å®¹ä¸ä¼šä¼ é€åˆ° PingCAPï¼Œè¯·æ”¾å¿ƒä½¿ç”¨ã€‚</span>
            <span lang="zh-TW">å¿«ç…§æª”æ¡ˆå®Œå…¨æ˜¯åœ¨å®¢æˆ¶ç«¯è™•ç†ï¼Œå…¶å…§å®¹ä¸æœƒå‚³é€åˆ° PingCAPï¼Œè«‹æ”¾å¿ƒä½¿ç”¨ã€‚</span>
        </p>
        <p><a href="#">â†‘
            <span lang="en-US">Return</span>
            <span lang="zh-CN">è¿”å›</span>
            <span lang="zh-TW">è¿”å›</span>
        </a></p>
    </div>
    -->

    <hr>

    <div class="p-5" id="restore-with-curl">
        <h1>
            <span lang="en-US">Import Grafana Snapshot File with cURL or Wget</span>
            <span lang="zh-CN">ä½¿ç”¨ cURL æˆ– Wget å¯¼å…¥ Grafana å¿«ç…§æ–‡ä»¶</span>
            <span lang="zh-TW">ä½¿ç”¨ cURL æˆ– Wget åŒ¯å…¥ Grafana å¿«ç…§æª”æ¡ˆ</span>
        </h1>

        <p lang="en-US">Suitable when there is an existing Grafana instance, cURL or Wget is accessible, but third-party software cannot be used.</p>
        <p lang="zh-CN">é€‚ç”¨äºå·²æœ‰ç°æˆçš„ Grafana å®ä¾‹ï¼Œå¯æ‰§è¡Œ cURL æˆ– Wgetï¼Œä½†ä¸æ–¹ä¾¿ä¸‹è½½ç¬¬ä¸‰æ–¹è½¯ä»¶ã€‚</p>
        <p lang="zh-TW">é©ç”¨æ–¼å·²æœ‰ç¾æˆçš„ Grafana å¯¦ä¾‹ï¼Œå¯é‹è¡Œ cURL æˆ– Wgetï¼Œä½†ä¸æ–¹ä¾¿ä¸‹è¼‰ç¬¬ä¸‰æ–¹è»Ÿé«”ã€‚</p>

        <ol>
            <li>
                <p lang="en-US">Prepare the Dashboard Snapshort JSON file, and note down the Grafana URL, login name and password.</p>
                <p lang="zh-CN">å‡†å¤‡å¥½è¦å¯¼å…¥çš„ç›‘æ§å¿«ç…§ JSON æ–‡ä»¶ï¼Œä»¥åŠ Grafana çš„åœ°å€å’Œç™»å…¥ç”¨æˆ·å¯†ç ã€‚</p>
                <p lang="zh-TW">æº–å‚™å¥½è¦åŒ¯å…¥çš„å„€è¡¨æ¿å¿«ç…§ JSON æª”æ¡ˆï¼Œä»¥åŠ Grafana çš„ä½å€å’Œç™»å…¥ç”¨æˆ¶å¯†ç¢¼ã€‚</p>
            </li>
            <li>
                <div id="import-buttons" class="btn-group float-right">
                    <button data-target="curl-script" type="button" class="btn btn-outline-dark btn-sm">curl</button>
                    <button data-target="wget-script" type="button" class="btn btn-outline-dark btn-sm">wget</button>
                </div>
                <p lang="en-US">Execute import command:</p>
                <p lang="zh-CN">æ‰§è¡Œå¯¼å…¥ï¼š</p>
                <p lang="zh-TW">é‹è¡ŒåŒ¯å…¥æŒ‡ä»¤ï¼š</p>
                <pre class="import-script" id="curl-script"><code>curl -H 'Content-Type: application/json' '<mark>http://admin:admin@localhost:3000</mark>/api/dashboards/import' --data-binary @<mark>/root/snap1.json</mark></code></pre>
                <pre class="import-script" id="wget-script" style="display:none;"><code>wget -qO- --header 'Content-Type: application/json' '<mark>http://admin:admin@localhost:3000</mark>/api/dashboards/import' --post-file <mark>/root/snap1.json</mark></code></pre>
                <p>
                    <span lang="en-US">in which:</span>
                    <span lang="zh-CN">å…¶ä¸­å‚æ•°æ˜¯ï¼š</span>
                    <span lang="zh-TW">å…¶ä¸­åƒæ•¸æ˜¯ï¼š</span>
                </p>
                <dl class="row">
                    <dt class="col-xl-3 col-lg-4">http://admin:admin@localhost:3000</dt>
                    <dd class="col-xl-9 col-lg-8">
                        <span lang="en-US">Login name, password, host and port of Grafana server</span>
                        <span lang="zh-CN">Grafana æœåŠ¡å™¨çš„ç™»å…¥ç”¨æˆ·åã€å¯†ç ã€åœ°å€å’Œç«¯å£</span>
                        <span lang="zh-TW">Grafana ä¼ºæœå™¨çš„ç™»å…¥ç”¨æˆ¶åç¨±ã€å¯†ç¢¼ã€ä½å€å’Œé€šè¨ŠåŸ </span>
                    </dd>
                    <dt class="col-xl-3 col-lg-4">/root/snap1.json</dt>
                    <dd class="col-xl-9 col-lg-8">
                        <span lang="en-US">Path of the imported JSON file</span>
                        <span lang="zh-CN">è¦å¯¼å…¥çš„ JSON æ–‡ä»¶è·¯å¾„</span>
                        <span lang="zh-TW">è¦åŒ¯å…¥çš„ JSON æª”æ¡ˆè·¯å¾‘</span>
                    </dd>
                </dl>
            </li>
            <li>
                <p lang="en-US">Output like this is shown after finishing. Open the marked URL to view the imported snapshot.</p>
                <p lang="zh-CN">å®Œæˆåä¼šæ‰“å°ç±»ä¼¼è¿™æ ·çš„åé¦ˆï¼Œæ‰“å¼€æ ‡ç¤ºå‡ºçš„ URL å³å¯æ£€è§†å¿«ç…§ã€‚</p>
                <p lang="zh-TW">å®Œæˆå¾Œæœƒè¼¸å‡ºé¡ä¼¼é€™æ¨£çš„çµæœï¼Œé–‹å•Ÿæ¨™ç¤ºå‡ºçš„ URL å³å¯æª¢è¦–å¿«ç…§ã€‚</p>
                <pre><code>{"pluginId":"",
 "title":"New Dashboard (exported at 2020-01-01T12:00:00.000Z)","imported":true,
 "importedUri":"db/new-dashboard-exported-at-2020-01-01t12-00-00-000z",
 "importedUrl":"<mark>/d/Q6RuHYIWk/new-dashboard-exported-at-2020-01-01t12-00-00-000z</mark>",
 "slug":"new-dashboard-exported-at-2020-01-01t12-00-00-000z",
 â€¦}</code></pre>
            </li>
        </ol>
        <p><a href="#">â†‘
            <span lang="en-US">Return</span>
            <span lang="zh-CN">è¿”å›</span>
            <span lang="zh-TW">è¿”å›</span>
        </a></p>
    </div>

    <hr>

    <div class="p-5" id="restore-with-cli">
        <h1>
            <span lang="en-US">Import Grafana Snapshot File with â€œgrafsnapâ€</span>
            <span lang="zh-CN">ä½¿ç”¨ grafsnap å‘½ä»¤è¡Œå·¥å…·å¯¼å…¥ Grafana å¿«ç…§æ–‡ä»¶</span>
            <span lang="zh-TW">ä½¿ç”¨ grafsnap å‘½ä»¤åˆ—ç¨‹å¼åŒ¯å…¥ Grafana å¿«ç…§æª”æ¡ˆ</span>
        </h1>

        <p lang="en-US">Suitable when there is an existing Grafana instance, and third-party software can be downloaded and run.</p>
        <p lang="zh-CN">é€‚ç”¨äºå·²æœ‰ç°æˆçš„ Grafana å®ä¾‹ï¼Œå¹¶ä¸”èƒ½ä¸‹è½½åŠæ‰§è¡Œå¤–éƒ¨å‘½ä»¤è¡Œå·¥å…·ã€‚</p>
        <p lang="zh-TW">é©ç”¨æ–¼å·²æœ‰ç¾æˆçš„ Grafana å¯¦ä¾‹ï¼Œä¸¦ä¸”èƒ½ä¸‹è¼‰åŠé‹è¡Œç¬¬ä¸‰æ–¹å‘½ä»¤åˆ—ç¨‹å¼ã€‚</p>

        <p class="text-muted">
            <span lang="en-US">Grafana is bundled with tiup playground, so you can quickly start a fresh instance with it if needed.</span>
            <span lang="zh-CN">å¦‚æœæ²¡æœ‰ç°æˆçš„ Grafana å®ä¾‹ï¼Œå¯ä»¥ä½¿ç”¨ tiup playground å¿«é€Ÿèµ·ä¸€ä¸ªã€‚</span>
            <span lang="zh-TW">å¦‚æœæ²’æœ‰ç¾æˆçš„ Grafana å¯¦ä¾‹ï¼Œå¯ä»¥ä½¿ç”¨ tiup playground å¿«é€Ÿå•Ÿå‹•ä¸€å€‹ã€‚</span>
        </p>

        <ol>
            <li>
                <p>
                    <span lang="en-US">Download</span>
                    <span lang="zh-CN">ä¸‹è½½</span>
                    <span lang="zh-TW">ä¸‹è¼‰</span>
                    <a href="https://github.com/kennytm/grafana-export/releases/download/v0.1.0/grafsnap-0.1.0-linux-x86_64.tar.gz">grafsnap 0.1.0</a>
                    <span lang="en-US">and extract it into the current folder.</span>
                    <span lang="zh-CN">å‹ç¼©åŒ…å¹¶è§£å‹åˆ°å½“å‰ç›®å½•ã€‚</span>
                    <span lang="zh-TW">å£“ç¸®æª”ä¸¦è§£å£“ç¸®åˆ°ç•¶å‰ç›®éŒ„ã€‚</span>
                </p>
                <pre><code>wget https://github.com/kennytm/grafana-export/releases/download/v0.1.0/grafsnap-0.1.0-linux-x86_64.tar.gz
tar xfv grafsnap-0.1.0-linux-x86_64.tar.gz</code></pre>
            </li>
            <li>
                <p lang="en-US">Prepare the Dashboard Snapshort JSON file.</p>
                <p lang="zh-CN">å‡†å¤‡å¥½è¦å¯¼å…¥çš„ç›‘æ§å¿«ç…§ JSON æ–‡ä»¶ã€‚</p>
                <p lang="zh-TW">æº–å‚™å¥½è¦åŒ¯å…¥çš„å„€è¡¨æ¿å¿«ç…§ JSON æª”æ¡ˆã€‚</p>
            </li>
            <li>
                <p lang="en-US">Execute import command:</p>
                <p lang="zh-CN">æ‰§è¡Œå¯¼å…¥ï¼š</p>
                <p lang="zh-TW">é‹è¡ŒåŒ¯å…¥æŒ‡ä»¤ï¼š</p>
                <pre><code>./grafsnap import -b '<mark>http://localhost:3000/</mark>' -k '<mark>admin:admin</mark>' <mark>~/snap1.json ~/snap2.json</mark></code></pre>
                <p>
                    <span lang="en-US">in which:</span>
                    <span lang="zh-CN">å…¶ä¸­å‚æ•°æ˜¯ï¼š</span>
                    <span lang="zh-TW">å…¶ä¸­åƒæ•¸æ˜¯ï¼š</span>
                </p>
                <dl class="row">
                    <dt class="col-xl-3 col-lg-4">-b 'http://localhost:3000/'</dt>
                    <dd class="col-xl-9 col-lg-8">
                        <span lang="en-US">Host and port of Grafana server</span>
                        <span lang="zh-CN">Grafana æœåŠ¡å™¨çš„åœ°å€å’Œç«¯å£</span>
                        <span lang="zh-TW">Grafana ä¼ºæœå™¨çš„ä½å€å’Œé€šè¨ŠåŸ </span>
                    </dd>
                    <dt class="col-xl-3 col-lg-4">-k 'admin:admin'</dt>
                    <dd class="col-xl-9 col-lg-8">
                        <span lang="en-US">Login name and password; you can also use an <a href="https://grafana.com/docs/grafana/latest/http_api/auth/">API Key</a></span>
                        <span lang="zh-CN">ç™»å…¥ç”¨æˆ·åå’Œå¯†ç ï¼›äº¦å¯ä»¥ä½¿ç”¨ <a href="https://grafana.com/docs/grafana/latest/http_api/auth/">API Key</a></span>
                        <span lang="zh-TW">ç™»å…¥ç”¨æˆ¶åç¨±å’Œå¯†ç¢¼ï¼›äº¦å¯ä»¥ä½¿ç”¨ <a href="https://grafana.com/docs/grafana/latest/http_api/auth/">API Key</a></span>
                    </dd>
                    <dt class="col-xl-3 col-lg-4">~/snap1.json ~/snap2.json</dt>
                    <dd class="col-xl-9 col-lg-8">
                        <span lang="en-US">Paths of the (multiple) imported JSON files</span>
                        <span lang="zh-CN">è¦å¯¼å…¥çš„ JSON æ–‡ä»¶è·¯å¾„ï¼Œå¯ä¸€æ¬¡å¯¼å…¥å¤šä¸ª</span>
                        <span lang="zh-TW">è¦åŒ¯å…¥çš„ JSON æª”æ¡ˆè·¯å¾‘ï¼Œå¯ä¸€æ¬¡åŒ¯å…¥å¤šå€‹</span>
                    </dd>
                </dl>
            </li>
            <li>
                <p lang="en-US">Output like this is shown after finishing. Open each URL to view the corresponding snapshot.</p>
                <p lang="zh-CN">å®Œæˆåä¼šæ‰“å°ç±»ä¼¼è¿™æ ·çš„åé¦ˆï¼Œæ‰“å¼€åˆ—å‡ºçš„ URL å³å¯æ£€è§†å¯¹åº”çš„å¿«ç…§ã€‚</p>
                <p lang="zh-TW">å®Œæˆå¾Œæœƒè¼¸å‡ºé¡ä¼¼é€™æ¨£çš„çµæœï¼Œé–‹å•Ÿåˆ—å‡ºçš„ URL å³å¯æª¢è¦–å°æ‡‰çš„å¿«ç…§ã€‚</p>
                <pre><code>[
    {
        "file": "snap1.json",
        "url": "<mark>http://localhost:3000/dashboard/snapshot/94prEd89WqqawEJkujYit5aHHkqbkKWs</mark>"
    },
    {
        "file": "snap2.json",
        "url": "<mark>http://localhost:3000/dashboard/snapshot/b4wJAg4OQ9t6yTddpawF6cImiG2MVpt2</mark>"
    }
]</code></pre>
            </li>
        </ol>
        <p><a href="#">â†‘
            <span lang="en-US">Return</span>
            <span lang="zh-CN">è¿”å›</span>
            <span lang="zh-TW">è¿”å›</span>
        </a></p>
    </div>


</main>

<script src="docs/jquery-3.5.1.slim.min.js"></script>
<script>
    $(document).ready(function() {
        var iframe = $('#script-iframe');
        var curLang = 'en-US';

        $('#copy-script-button').show().click(function() {
            $('#script-container > textarea:visible').focus().select();
            document.execCommand('copy');
            var copiedNote = $('#copied-note').show();
            setTimeout(function() {
                copiedNote.hide();
            }, 1000);
        });

        $('.dropdown-toggle').on('focus blur', function(e) {
            var menu = $(this).siblings('.dropdown-menu');
            if (e.type === 'focus') {
                menu.show();
            } else {
                setTimeout(function() { menu.hide(); }, 200);
            }
        });

        $('#lang-selector').prop('disabled', false).change(function() {
            var rules = document.styleSheets[1].cssRules;
            curLang = this.value;
            for (var i = 0; i < rules.length; i++) {
                var rule = rules[i];
                var st = rule.selectorText;
                if (st) {
                    rule.selectorText = st.replace(/\[lang=[^\]]+\]/, '[lang='+this.value+']');
                }
            }
        }).change();

        $('#import-buttons > button').click(function() {
            $('.import-script').hide();
            $('#' + $(this).data('target')).show();
        });

        $('#manual-url-field').on('keyup change', function() {
            var link = $('#manual-url-link');
            var invalid = $('#manual-url-invalid');
            if (/\/dashboard\/snapshot\//.test(this.value)) {
                var url = this.value.replace(/\/dashboard\/snapshot\//, '/api/snapshots/');
                link.attr('href', url).text(url);
                invalid.hide();
            } else {
                link.removeAttr('href').text('');
                invalid.show();
            }
        }).change();
    });
</script>
</body>
</html>
