<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="stylesheet" href="docs/bootstrap.min.css" />

<title>Grafana Snapshot Export/Import Guide</title>

<style>
    ol > li {
        padding-top: 2rem;
    }
    ol > li::marker {
        font-weight: bold;
    }
    pre {
        background: #eee;
        padding: 0.5rem;
    }
    @keyframes fade-out {
        50% { opacity: 1; }
        to { opacity: 0; }
    }
    #copied-note {
        animation: fade-out 1s forwards;
    }
    hr {
        margin-top: 20rem;
    }

    [lang] {
        display: none;
    }

    p[lang=en-US] {
        display: block;
    }
    span[lang=en-US] {
        display: inline;
    }
    textarea[lang=en-US] {
        display: block;
    }
</style>

</head>
<body>
<nav class="navbar navbar-expand navbar-light bg-light fixed-top">
    <div class="navbar-collapse collapse">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item">
                <a class="nav-link" href="#backup-with-dev-tools">
                    <span lang="en-US">Export</span>
                    <span lang="zh-CN">导出</span>
                    <span lang="zh-TW">匯出</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#viz">
                    <span lang="en-US">Visualize</span>
                    <span lang="zh-CN">检视</span>
                    <span lang="zh-TW">檢視</span>
                </a>
            </li>
            <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="javascript:void 0">
                    <span lang="en-US">Import</span>
                    <span lang="zh-CN">导入</span>
                    <span lang="zh-TW">匯入</span>
                </a>
                <div class="dropdown-menu">
                    <a class="dropdown-item" href="#restore-with-curl">cURL / Wget</a>
                    <a class="dropdown-item" href="#restore-with-cli">grafsnap</a>
                </div>
            </li>
        </ul>
        <form class="form-inline">
            <select class="form-control" id="lang-selector" disabled>
                <option value="en-US" selected>English</option>
                <option value="zh-CN">简体中文</option>
                <option value="zh-TW">繁體中文</option>
            </select>
        </form>
    </div>
</nav>

<main>
    <div class="container vh-100 d-flex align-items-center py-5">
        <div class="card-deck">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">
                        <span lang="en-US">Export</span>
                        <span lang="zh-CN">导出</span>
                        <span lang="zh-TW">匯出</span>
                    </h5>
                    <ul class="card-text">
                        <li><a href="#backup-with-dev-tools">
                            <span lang="en-US">Export from Grafana Dashboard UI</span>
                            <span lang="zh-CN">在 Grafana 监控界面上导出快照</span>
                            <span lang="zh-TW">在 Grafana 儀表板介面上匯出快照</span>
                        </a></li>
                    </ul>
                </div>
            </div>
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">
                        <span lang="en-US">Visualize</span>
                        <span lang="zh-CN">检视</span>
                        <span lang="zh-TW">檢視</span>
                    </h5>
                    <ul class="card-text">
                        <li>
                            <a href="#viz">
                                <span lang="en-US">Visualize Snapshot File</span>
                                <span lang="zh-CN">在网页上检视快照文件</span>
                                <span lang="zh-TW">在網頁上檢視快照檔案</span>
                            </a>
                            <a href="https://metricstool.pingcap.com/viz/" target="_blank">↗</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">
                        <span lang="en-US">Import</span>
                        <span lang="zh-CN">导入</span>
                        <span lang="zh-TW">匯入</span>
                    </h5>
                    <p class="card-text">
                        <span lang="en-US">There are multiple ways to import snapshot files back into Grafana</span>
                        <span lang="zh-CN">以下列出多种方法可以导入先前导出的 Grafana 监控快照</span>
                        <span lang="zh-TW">以下列出多種方法可以匯入之前匯出的 Grafana 儀表板快照</span>
                    </p>
                    <ul class="card-text">
                        <li><a href="#restore-with-curl">
                            <span lang="en-US">Using cURL or Wget</span>
                            <span lang="zh-CN">使用 cURL 或 Wget</span>
                            <span lang="zh-TW">使用 cURL 或 Wget</span>
                        </a></li>
                        <li><a href="#restore-with-cli">
                            <span lang="en-US">Using CLI tool “grafsnap”</span>
                            <span lang="zh-CN">使用 grafsnap 命令行工具</span>
                            <span lang="zh-TW">使用 grafsnap 命令列程式</span>
                        </a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <hr>

    <div class="p-5" id="backup-with-dev-tools">
        <h1>
            <span lang="en-US">Export Snapshot from Grafana Dashboard UI</span>
            <span lang="zh-CN">在 Grafana 界面上导出</span>
            <span lang="zh-TW">從 Grafana 介面上匯出</span>
        </h1>
        <p lang="en-US">Supported on Chrome, Edge and Firefox browsers</p>
        <p lang="zh-CN">适用于 Chrome / Edge / Firefox 浏览器</p>
        <p lang="zh-TW">適用於 Chrome / Edge / Firefox 瀏覽器</p>
        <ol>
            <li>
                <p>
                    <button type="button" class="btn btn-outline-primary" id="copy-script-button">
                        <span lang="en-US">Copy the script below</span>
                        <span lang="zh-CN">复制以下脚本</span>
                        <span lang="zh-TW">複製以下指令碼</span>
                    </button>
                    <em id="copied-note" style="display:none;">
                        <span lang="en-US">Copied!</span>
                        <span lang="zh-CN">已复制！</span>
                        <span lang="zh-TW">已複製！</span>
                    </em>
                </p>
                <p class="w-100" id="script-container">
                    <textarea lang="en-US" class="w-100" readonly rows="5" cols="100">/* Copyright 2020 PingCAP, Inc. Licensed under MIT. */
&quot;use strict&quot;
const t={t:&quot;Script failed to run. Please ensure it is running on the Grafana v6.x.x dashboard page.&quot;,
s:&quot;Going to export snapshot of the current dashboard: &quot;,i:&quot;Note: Only metrics from visible panels can be exported&quot;,
o:&quot;Number of panels&quot;,h:&quot;Loading panels&quot;,l:&quot;Expand all rows&quot;,p:&quot;Export&quot;,m:&quot;Export immediately&quot;,cancel:&quot;Cancel&quot;}
try{
const e=angular.element,s=document.styleSheets[0],i=[&quot;.__dexport_hint{z-index:2222;position:fixed;background:#fff;color:#000;padding:1em;font-size:18px;border-left:3px solid #faad14;right:0;top:5em;opacity:.8;min-width:30em}&quot;,&quot;.__dexport_hint:hover{opacity:1}&quot;,&quot;.__dexport_hint button{margin:0 1em}&quot;,&quot;.__dexport_hint button[disabled]{opacity:.5}&quot;,&quot;.__dexport_hint progress{margin-right:1em;vertical-align:middle;width:18em}&quot;]
class o{constructor(){const o=e(document).injector()
this.u=o.get(&quot;timeSrv&quot;)
const n=this.u.dashboard
i.forEach(t=&gt;s.insertRule(t,0)),this.g=e(&quot;&lt;span&gt;&quot;),this._=e(&#39;&lt;progress value=&quot;0&quot;&gt;&#39;),
this.v=e(&#39;&lt;button style=&quot;font-weight:bold&quot;&gt;&#39;).text(t.p).one(&quot;click&quot;,()=&gt;this.$()),
this.P=e(&quot;&lt;button&gt;&quot;).text(t.l).on(&quot;click&quot;,()=&gt;n.expandRows())
const a=/^(Mac|iP)/.test(navigator.platform)?&quot;flex-direction:row-reverse&quot;:&quot;justify-content:center&quot;
this.k=e(&#39;&lt;div class=&quot;__dexport_hint&quot;&gt;&#39;).append(e(&quot;&lt;p&gt;&quot;).text(t.s).append(e(&quot;&lt;strong&gt;&quot;).text(n.title)),e(&quot;&lt;p&gt;&quot;).text(t.i).append(this.P),e(&#39;&lt;p style=&quot;font-size:.8em&quot;&gt;&#39;).append(this._,this.g),e(`&lt;p style=&quot;display:flex;${a}&quot;&gt;`).append(this.v,e(&quot;&lt;button&gt;&quot;).text(t.cancel).on(&quot;click&quot;,()=&gt;this.S()))),
this.I=0,e(document.body).append(this.k),this.j=setInterval(()=&gt;this.L(),500)}L(){const s=e(&quot;.panel-loading&quot;),i=s.length
if(0===this.I)this.g.text(`${t.o}: ${i}`),this.v.prop(&quot;disabled&quot;,0===i)
else{const e=s.filter(&quot;.ng-hide&quot;).length,o=(100*e/i||0).toFixed(1)
this.g.text(`${t.h}: ${o}% (${e}/${i})`),this._.prop({value:e,max:i}),i&gt;e?2!==this.I&amp;&amp;(this.I=2,
this.v.prop(&quot;disabled&quot;,!1).text(t.m).one(&quot;click&quot;,()=&gt;this.N())):this.N()}}$(){const t=this.u.dashboard
this.I=1,this.v.prop(&quot;disabled&quot;,!0),this.O=t.refresh,this.u.setAutoRefresh(),e(&quot;.panel-loading&quot;).removeClass(&quot;ng-hide&quot;),
t.snapshot={timestamp:new Date},t.startRefresh()}N(){
const t=this.u.dashboard,s=t.snapshot.timestamp.toISOString(),i=t.getSaveModelClone()
i.time=this.u.timeRange()
const o={meta:{isSnapshot:!0,type:&quot;snapshot&quot;,expires:&quot;9999-12-31T23:59:59Z&quot;,created:s},dashboard:i}
this.S()
const n=new Blob([JSON.stringify(o)],{type:&quot;application/json&quot;}),a=URL.createObjectURL(n),r=e(&quot;&lt;a&gt;&quot;)
r.prop({href:a,download:`${i.title}_${s}.json`}),e(document.body).append(r),r[0].click(),setTimeout(()=&gt;{
URL.revokeObjectURL(a),r.remove()},0)}S(){const t=this.u.dashboard
delete t.snapshot,t.forEachPanel(t=&gt;delete t.snapshotData),t.annotations.list.forEach(t=&gt;delete t.snapshotData),
this.O&amp;&amp;this.u.setAutoRefresh(this.O),clearInterval(this.j),this.k.remove(),i.forEach(()=&gt;s.deleteRule(0))}}new o
}catch(e){console.error(e),alert(t.t)}</textarea>
                    <textarea lang="zh-CN" class="w-100" readonly rows="5" cols="100">/* Copyright 2020 PingCAP, Inc. Licensed under MIT. */
&quot;use strict&quot;
const t={t:&quot;执行失败。请确保是在 Grafana v6.x.x 的监控网页上执行脚本。&quot;,i:&quot;将导出当前的监控页面：&quot;,s:&quot;注意：只有已展开面板内的监控会被导出&quot;,o:&quot;面板数量&quot;,h:&quot;加载面板中&quot;,l:&quot;展开所有面板&quot;,
p:&quot;导出&quot;,m:&quot;立刻导出&quot;,cancel:&quot;取消&quot;}
try{
const e=angular.element,i=document.styleSheets[0],s=[&quot;.__dexport_hint{z-index:2222;position:fixed;background:#fff;color:#000;padding:1em;font-size:18px;border-left:3px solid #faad14;right:0;top:5em;opacity:.8;min-width:30em}&quot;,&quot;.__dexport_hint:hover{opacity:1}&quot;,&quot;.__dexport_hint button{margin:0 1em}&quot;,&quot;.__dexport_hint button[disabled]{opacity:.5}&quot;,&quot;.__dexport_hint progress{margin-right:1em;vertical-align:middle;width:18em}&quot;]
class o{constructor(){const o=e(document).injector()
this.u=o.get(&quot;timeSrv&quot;)
const n=this.u.dashboard
s.forEach(t=&gt;i.insertRule(t,0)),this.g=e(&quot;&lt;span&gt;&quot;),this._=e(&#39;&lt;progress value=&quot;0&quot;&gt;&#39;),
this.v=e(&#39;&lt;button style=&quot;font-weight:bold&quot;&gt;&#39;).text(t.p).one(&quot;click&quot;,()=&gt;this.$()),
this.k=e(&quot;&lt;button&gt;&quot;).text(t.l).on(&quot;click&quot;,()=&gt;n.expandRows())
const a=/^(Mac|iP)/.test(navigator.platform)?&quot;flex-direction:row-reverse&quot;:&quot;justify-content:center&quot;
this.P=e(&#39;&lt;div class=&quot;__dexport_hint&quot;&gt;&#39;).append(e(&quot;&lt;p&gt;&quot;).text(t.i).append(e(&quot;&lt;strong&gt;&quot;).text(n.title)),e(&quot;&lt;p&gt;&quot;).text(t.s).append(this.k),e(&#39;&lt;p style=&quot;font-size:.8em&quot;&gt;&#39;).append(this._,this.g),e(`&lt;p style=&quot;display:flex;${a}&quot;&gt;`).append(this.v,e(&quot;&lt;button&gt;&quot;).text(t.cancel).on(&quot;click&quot;,()=&gt;this.I()))),
this.S=0,e(document.body).append(this.P),this.j=setInterval(()=&gt;this.T(),500)}T(){const i=e(&quot;.panel-loading&quot;),s=i.length
if(0===this.S)this.g.text(`${t.o}: ${s}`),this.v.prop(&quot;disabled&quot;,0===s)
else{const e=i.filter(&quot;.ng-hide&quot;).length,o=(100*e/s||0).toFixed(1)
this.g.text(`${t.h}: ${o}% (${e}/${s})`),this._.prop({value:e,max:s}),s&gt;e?2!==this.S&amp;&amp;(this.S=2,
this.v.prop(&quot;disabled&quot;,!1).text(t.m).one(&quot;click&quot;,()=&gt;this.U())):this.U()}}$(){const t=this.u.dashboard
this.S=1,this.v.prop(&quot;disabled&quot;,!0),this.L=t.refresh,this.u.setAutoRefresh(),e(&quot;.panel-loading&quot;).removeClass(&quot;ng-hide&quot;),
t.snapshot={timestamp:new Date},t.startRefresh()}U(){
const t=this.u.dashboard,i=t.snapshot.timestamp.toISOString(),s=t.getSaveModelClone()
s.time=this.u.timeRange()
const o={meta:{isSnapshot:!0,type:&quot;snapshot&quot;,expires:&quot;9999-12-31T23:59:59Z&quot;,created:i},dashboard:s}
this.I()
const n=new Blob([JSON.stringify(o)],{type:&quot;application/json&quot;}),a=URL.createObjectURL(n),h=e(&quot;&lt;a&gt;&quot;)
h.prop({href:a,download:`${s.title}_${i}.json`}),e(document.body).append(h),h[0].click(),setTimeout(()=&gt;{
URL.revokeObjectURL(a),h.remove()},0)}I(){const t=this.u.dashboard
delete t.snapshot,t.forEachPanel(t=&gt;delete t.snapshotData),t.annotations.list.forEach(t=&gt;delete t.snapshotData),
this.L&amp;&amp;this.u.setAutoRefresh(this.L),clearInterval(this.j),this.P.remove(),s.forEach(()=&gt;i.deleteRule(0))}}new o
}catch(e){console.error(e),alert(t.t)}</textarea>
                    <textarea lang="zh-TW" class="w-100" readonly rows="5" cols="100">/* Copyright 2020 PingCAP, Inc. Licensed under MIT. */
&quot;use strict&quot;
const t={t:&quot;執行失敗。請確保是在 Grafana v6.x.x 的儀表板上執行劇本。&quot;,i:&quot;即將匯出當前儀表板：&quot;,s:&quot;注意：只能匯出已展開的面板內的資料&quot;,o:&quot;面板數量&quot;,h:&quot;載入面板中&quot;,l:&quot;展開所有面板&quot;,
p:&quot;匯出&quot;,m:&quot;立即匯出&quot;,cancel:&quot;取消&quot;}
try{
const e=angular.element,i=document.styleSheets[0],s=[&quot;.__dexport_hint{z-index:2222;position:fixed;background:#fff;color:#000;padding:1em;font-size:18px;border-left:3px solid #faad14;right:0;top:5em;opacity:.8;min-width:30em}&quot;,&quot;.__dexport_hint:hover{opacity:1}&quot;,&quot;.__dexport_hint button{margin:0 1em}&quot;,&quot;.__dexport_hint button[disabled]{opacity:.5}&quot;,&quot;.__dexport_hint progress{margin-right:1em;vertical-align:middle;width:18em}&quot;]
class o{constructor(){const o=e(document).injector()
this.u=o.get(&quot;timeSrv&quot;)
const n=this.u.dashboard
s.forEach(t=&gt;i.insertRule(t,0)),this.g=e(&quot;&lt;span&gt;&quot;),this._=e(&#39;&lt;progress value=&quot;0&quot;&gt;&#39;),
this.v=e(&#39;&lt;button style=&quot;font-weight:bold&quot;&gt;&#39;).text(t.p).one(&quot;click&quot;,()=&gt;this.$()),
this.k=e(&quot;&lt;button&gt;&quot;).text(t.l).on(&quot;click&quot;,()=&gt;n.expandRows())
const a=/^(Mac|iP)/.test(navigator.platform)?&quot;flex-direction:row-reverse&quot;:&quot;justify-content:center&quot;
this.P=e(&#39;&lt;div class=&quot;__dexport_hint&quot;&gt;&#39;).append(e(&quot;&lt;p&gt;&quot;).text(t.i).append(e(&quot;&lt;strong&gt;&quot;).text(n.title)),e(&quot;&lt;p&gt;&quot;).text(t.s).append(this.k),e(&#39;&lt;p style=&quot;font-size:.8em&quot;&gt;&#39;).append(this._,this.g),e(`&lt;p style=&quot;display:flex;${a}&quot;&gt;`).append(this.v,e(&quot;&lt;button&gt;&quot;).text(t.cancel).on(&quot;click&quot;,()=&gt;this.I()))),
this.S=0,e(document.body).append(this.P),this.j=setInterval(()=&gt;this.T(),500)}T(){const i=e(&quot;.panel-loading&quot;),s=i.length
if(0===this.S)this.g.text(`${t.o}: ${s}`),this.v.prop(&quot;disabled&quot;,0===s)
else{const e=i.filter(&quot;.ng-hide&quot;).length,o=(100*e/s||0).toFixed(1)
this.g.text(`${t.h}: ${o}% (${e}/${s})`),this._.prop({value:e,max:s}),s&gt;e?2!==this.S&amp;&amp;(this.S=2,
this.v.prop(&quot;disabled&quot;,!1).text(t.m).one(&quot;click&quot;,()=&gt;this.U())):this.U()}}$(){const t=this.u.dashboard
this.S=1,this.v.prop(&quot;disabled&quot;,!0),this.L=t.refresh,this.u.setAutoRefresh(),e(&quot;.panel-loading&quot;).removeClass(&quot;ng-hide&quot;),
t.snapshot={timestamp:new Date},t.startRefresh()}U(){
const t=this.u.dashboard,i=t.snapshot.timestamp.toISOString(),s=t.getSaveModelClone()
s.time=this.u.timeRange()
const o={meta:{isSnapshot:!0,type:&quot;snapshot&quot;,expires:&quot;9999-12-31T23:59:59Z&quot;,created:i},dashboard:s}
this.I()
const n=new Blob([JSON.stringify(o)],{type:&quot;application/json&quot;}),a=URL.createObjectURL(n),h=e(&quot;&lt;a&gt;&quot;)
h.prop({href:a,download:`${s.title}_${i}.json`}),e(document.body).append(h),h[0].click(),setTimeout(()=&gt;{
URL.revokeObjectURL(a),h.remove()},0)}I(){const t=this.u.dashboard
delete t.snapshot,t.forEachPanel(t=&gt;delete t.snapshotData),t.annotations.list.forEach(t=&gt;delete t.snapshotData),
this.L&amp;&amp;this.u.setAutoRefresh(this.L),clearInterval(this.j),this.P.remove(),s.forEach(()=&gt;i.deleteRule(0))}}new o
}catch(e){console.error(e),alert(t.t)}</textarea>
                </p>
            </li>
            <li>
                <p lang="en-US">After opening a Grafana Dashboard, press <kbd>F12</kbd> the launch the Developer Tool, and then paste the script in the “Console” tab.</p>
                <p lang="zh-CN">在 Grafana 监控面板中按下 <kbd>F12</kbd> 启动开发者工具，在 “Console” 面板下粘贴脚本。</p>
                <p lang="zh-TW">在 Grafana 儀表板中按下 <kbd>F12</kbd> 啟動開發者工具，在「Console」頁下貼上指令碼。</p>
                <p><img src="docs/dev-tools-5.png" class="img-fluid" alt="Pasting the script into the Developer Tool Console"></p>
            </li>
            <li>
                <p lang="en-US">Press <kbd>Enter</kbd> to execute the script. A dialog should now appear on the web page. Follow its instruction to continue.</p>
                <p lang="zh-CN">按下 <kbd>回车 (Enter)</kbd> 执行脚本。此时 Grafana 网页中会出现操作提示框，请遵循其指示进行后续操作。</p>
                <p lang="zh-TW">按下 <kbd>輸入 (Enter)</kbd> 運行指令碼。此時 Grafana 網面中會出現操作提示框，請遵循其指示繼續操作。</p>
                <p><img src="docs/dev-tools-6.png" class="img-fluid" alt="The dialog in the Dashboard"></p>
            </li>
        </ol>
        <p><a href="#">↑
            <span lang="en-US">Return</span>
            <span lang="zh-CN">返回</span>
            <span lang="zh-TW">返回</span>
        </a></p>
    </div>

    <!--<hr>

    <div id="backup-with-manual" class="p-5">
        <h1>手动取出本地快照</h1>

        <p>如果不懂或不能使用浏览器的<abbr title="Development tools">开发工具</abbr>，可尝试这个方法。</p>

        <ol>
            <li>
                <p>使用浏览器登入至 Grafana。</p>
            </li>
            <li>
                <p>打开要导出的<abbr title="Dashboard">监控面板</abbr>。</p>
            </li>
            <li>
                <p>手动展开所有面板（只有显示的面板才会被保存）。</p>
            </li>
            <li>
                <p>点击右上角工具列中的 “Share dashboard” 按钮。</p>
                <p><img src="docs/manual-1.png" class="img-fluid" alt="“Share dashboard” 按钮"></p>
            </li>
            <li>
                <p>选择 “Snapshot” 页，然后点击 “Local snapshot”。</p>
                <p><img src="docs/manual-4.png" class="img-fluid" alt="“Local snapshot” 按钮"></p>
            </li>
            <li>
                <p>等待快取完成，完成后会出现一个连接。</p>
                <p><img src="docs/manual-2.png" class="img-fluid" alt="“Local snapshot” 的连接"></p>
            </li>
            <li>
                <p>复制连接，把当中的 <code>dashboard/snapshot</code> 部分取代为 <code>api/snapshots</code>，然后打开这个新连接。</p>
                <p>
                    <img src="docs/manual-3a.png" class="img-fluid" alt="localhost:3000/dashboard/snapshot/..."><br>
                    ↓<br>
                    <img src="docs/manual-3b.png" class="img-fluid" alt="localhost:3000/api/snapshots/...">
                </p>
            </li>
            <li>
                <p>储存当前页面为一个 JSON 文件（<kbd>Ctrl</kbd>+<kbd>S</kbd>）。</p>
            </li>
            <li>
                <p>从第 2 步开始继续导出其他监控面板。</p>
            </li>
        </ol>
        <p><a href="#top">↑ 返回</a></p>
    </div>-->

    <hr>

    <div class="p-5" id="viz">
        <h1>
            <span lang="en-US">Visualize Snapshot File on Web Page</span>
            <span lang="zh-CN">在网页上检视快照文件</span>
            <span lang="zh-TW">在網頁上檢視快照檔案</span>
        </h1>

        <ol>
            <li>
                <p>
                    <span lang="en-US">Open</span>
                    <span lang="zh-CN">打开</span>
                    <span lang="zh-TW">開啟</span>
                    <a href="https://metricstool.pingcap.com/viz/">https://metricstool.pingcap.com/viz/</a>.
                </p>
            </li>
            <li>
                <p lang="en-US">Click “Open snapshot” and choose the exported Snapshot File to visualize.</p>
                <p lang="zh-CN">点选 “Open snapshot” 打开要检视的快照文件。</p>
                <p lang="zh-TW">點選「Open snapshot」開啟要檢視的快照檔案。</p>
                <p><img src="docs/viz.png" class="img-fluid" alt="Visualized graph"></p>
            </li>
        </ol>

        <p class="text-muted">
            <span lang="en-US">The snapshot is rendered entirely on client side. Nothing will be sent to PingCAP.</span>
            <span lang="zh-CN">快照文件完全是在客戶端处理，其内容不会传送到 PingCAP，请放心使用。</span>
            <span lang="zh-TW">快照檔案完全是在客戶端處理，其內容不會傳送到 PingCAP，請放心使用。</span>
        </p>
        <p><a href="#">↑
            <span lang="en-US">Return</span>
            <span lang="zh-CN">返回</span>
            <span lang="zh-TW">返回</span>
        </a></p>
    </div>

    <hr>

    <div class="p-5" id="restore-with-curl">
        <h1>
            <span lang="en-US">Import Grafana Snapshot File with cURL or Wget</span>
            <span lang="zh-CN">使用 cURL 或 Wget 导入 Grafana 快照文件</span>
            <span lang="zh-TW">使用 cURL 或 Wget 匯入 Grafana 快照檔案</span>
        </h1>

        <p lang="en-US">Suitable when there is an existing Grafana instance, cURL or Wget is accessible, but third-party software cannot be used.</p>
        <p lang="zh-CN">适用于已有现成的 Grafana 实例，可执行 cURL 或 Wget，但不方便下载第三方软件。</p>
        <p lang="zh-TW">適用於已有現成的 Grafana 實例，可運行 cURL 或 Wget，但不方便下載第三方軟體。</p>

        <ol>
            <li>
                <p lang="en-US">Prepare the Dashboard Snapshort JSON file, and note down the Grafana URL, login name and password.</p>
                <p lang="zh-CN">准备好要导入的监控快照 JSON 文件，以及 Grafana 的地址和登入用户密码。</p>
                <p lang="zh-TW">準備好要匯入的儀表板快照 JSON 檔案，以及 Grafana 的位址和登入用戶密碼。</p>
            </li>
            <li>
                <div id="import-buttons" class="btn-group float-right">
                    <button data-target="curl-script" type="button" class="btn btn-outline-dark btn-sm">curl</button>
                    <button data-target="wget-script" type="button" class="btn btn-outline-dark btn-sm">wget</button>
                </div>
                <p lang="en-US">Execute import command:</p>
                <p lang="zh-CN">执行导入：</p>
                <p lang="zh-TW">運行匯入指令：</p>
                <pre class="import-script" id="curl-script"><code>curl -H 'Content-Type: application/json' '<mark>http://admin:admin@localhost:3000</mark>/api/snapshots' --data-binary @<mark>/root/snap1.json</mark></code></pre>
                <pre class="import-script" id="wget-script" style="display:none;"><code>wget -qO- --header 'Content-Type: application/json' '<mark>http://admin:admin@localhost:3000</mark>/api/snapshots' --post-file <mark>/root/snap1.json</mark></code></pre>
                <p>
                    <span lang="en-US">in which:</span>
                    <span lang="zh-CN">其中参数是：</span>
                    <span lang="zh-TW">其中參數是：</span>
                </p>
                <dl class="row">
                    <dt class="col-xl-3 col-lg-4">http://admin:admin@localhost:3000</dt>
                    <dd class="col-xl-9 col-lg-8">
                        <span lang="en-US">Login name, password, host and port of Grafana server</span>
                        <span lang="zh-CN">Grafana 服务器的登入用户名、密码、地址和端口</span>
                        <span lang="zh-TW">Grafana 伺服器的登入用戶名稱、密碼、位址和通訊埠</span>
                    </dd>
                    <dt class="col-xl-3 col-lg-4">/root/snap1.json</dt>
                    <dd class="col-xl-9 col-lg-8">
                        <span lang="en-US">Path of the imported JSON file</span>
                        <span lang="zh-CN">要导入的 JSON 文件路径</span>
                        <span lang="zh-TW">要匯入的 JSON 檔案路徑</span>
                    </dd>
                </dl>
            </li>
            <li>
                <p lang="en-US">Output like this is shown after finishing. Open the URL at the end to view the imported snapshot.</p>
                <p lang="zh-CN">完成后会打印类似这样的反馈，打开最后列出的 URL 即可检视快照。</p>
                <p lang="zh-TW">完成後會輸出類似這樣的結果，開啟最後列出的 URL 即可檢視快照。</p>
                <pre><code>{"deleteKey":"8LvAhyp4oYgh2lxivj6b2Z1APDMS2azi",
 "deleteUrl":"http://localhost:3000/api/snapshots-delete/8LvAhyp4oYgh2lxivj6b2Z1APDMS2azi",
 "key":"icoOxTDyQx4j6XLc4TCwZTiTBbma6AAN",
 "url":"<mark>http://localhost:3000/dashboard/snapshot/icoOxTDyQx4j6XLc4TCwZTiTBbma6AAN</mark>"}</code></pre>
            </li>
        </ol>
        <p><a href="#">↑
            <span lang="en-US">Return</span>
            <span lang="zh-CN">返回</span>
            <span lang="zh-TW">返回</span>
        </a></p>
    </div>

    <hr>

    <div class="p-5" id="restore-with-cli">
        <h1>
            <span lang="en-US">Import Grafana Snapshot File with “grafsnap”</span>
            <span lang="zh-CN">使用 grafsnap 命令行工具导入 Grafana 快照文件</span>
            <span lang="zh-TW">使用 grafsnap 命令列程式匯入 Grafana 快照檔案</span>
        </h1>

        <p lang="en-US">Suitable when there is an existing Grafana instance, and third-party software can be downloaded and run.</p>
        <p lang="zh-CN">适用于已有现成的 Grafana 实例，并且能下载及执行外部命令行工具。</p>
        <p lang="zh-TW">適用於已有現成的 Grafana 實例，並且能下載及運行第三方命令列程式。</p>

        <p class="text-muted">
            <span lang="en-US">Grafana is bundled with tiup playground, so you can quickly start a fresh instance with it if needed.</span>
            <span lang="zh-CN">如果没有现成的 Grafana 实例，可以使用 tiup playground 快速起一个。</span>
            <span lang="zh-TW">如果沒有現成的 Grafana 實例，可以使用 tiup playground 快速啟動一個。</span>
        </p>

        <ol>
            <li>
                <p>
                    <span lang="en-US">Download</span>
                    <span lang="zh-CN">下载</span>
                    <span lang="zh-TW">下載</span>
                    <a href="https://github.com/kennytm/grafana-export/releases/download/v0.1.0/grafsnap-0.1.0-linux-x86_64.tar.gz">grafsnap 0.1.0</a>
                    <span lang="en-US">and extract it into the current folder.</span>
                    <span lang="zh-CN">压缩包并解压到当前目录。</span>
                    <span lang="zh-TW">壓縮檔並解壓縮到當前目錄。</span>
                </p>
                <pre><code>wget https://github.com/kennytm/grafana-export/releases/download/v0.1.0/grafsnap-0.1.0-linux-x86_64.tar.gz
tar xfv grafsnap-0.1.0-linux-x86_64.tar.gz</code></pre>
            </li>
            <li>
                <p lang="en-US">Prepare the Dashboard Snapshort JSON file.</p>
                <p lang="zh-CN">准备好要导入的监控快照 JSON 文件。</p>
                <p lang="zh-TW">準備好要匯入的儀表板快照 JSON 檔案。</p>
            </li>
            <li>
                <p lang="en-US">Execute import command:</p>
                <p lang="zh-CN">执行导入：</p>
                <p lang="zh-TW">運行匯入指令：</p>
                <pre><code>./grafsnap import -b '<mark>http://localhost:3000/</mark>' -k '<mark>admin:admin</mark>' <mark>~/snap1.json ~/snap2.json</mark></code></pre>
                <p>
                    <span lang="en-US">in which:</span>
                    <span lang="zh-CN">其中参数是：</span>
                    <span lang="zh-TW">其中參數是：</span>
                </p>
                <dl class="row">
                    <dt class="col-xl-3 col-lg-4">-b 'http://localhost:3000/'</dt>
                    <dd class="col-xl-9 col-lg-8">
                        <span lang="en-US">Host and port of Grafana server</span>
                        <span lang="zh-CN">Grafana 服务器的地址和端口</span>
                        <span lang="zh-TW">Grafana 伺服器的位址和通訊埠</span>
                    </dd>
                    <dt class="col-xl-3 col-lg-4">-k 'admin:admin'</dt>
                    <dd class="col-xl-9 col-lg-8">
                        <span lang="en-US">Login name and password; you can also use an <a href="https://grafana.com/docs/grafana/latest/http_api/auth/">API Key</a></span>
                        <span lang="zh-CN">登入用户名和密码；亦可以使用 <a href="https://grafana.com/docs/grafana/latest/http_api/auth/">API Key</a></span>
                        <span lang="zh-TW">登入用戶名稱和密碼；亦可以使用 <a href="https://grafana.com/docs/grafana/latest/http_api/auth/">API Key</a></span>
                    </dd>
                    <dt class="col-xl-3 col-lg-4">~/snap1.json ~/snap2.json</dt>
                    <dd class="col-xl-9 col-lg-8">
                        <span lang="en-US">Paths of the (multiple) imported JSON files</span>
                        <span lang="zh-CN">要导入的 JSON 文件路径，可一次导入多个</span>
                        <span lang="zh-TW">要匯入的 JSON 檔案路徑，可一次匯入多個</span>
                    </dd>
                </dl>
            </li>
            <li>
                <p lang="en-US">Output like this is shown after finishing. Open each URL to view the corresponding snapshot.</p>
                <p lang="zh-CN">完成后会打印类似这样的反馈，打开列出的 URL 即可检视对应的快照。</p>
                <p lang="zh-TW">完成後會輸出類似這樣的結果，開啟列出的 URL 即可檢視對應的快照。</p>
                <pre><code>[
    {
        "file": "snap1.json",
        "url": "<mark>http://localhost:3000/dashboard/snapshot/94prEd89WqqawEJkujYit5aHHkqbkKWs</mark>"
    },
    {
        "file": "snap2.json",
        "url": "<mark>http://localhost:3000/dashboard/snapshot/b4wJAg4OQ9t6yTddpawF6cImiG2MVpt2</mark>"
    }
]</code></pre>
            </li>
        </ol>
        <p><a href="#">↑
            <span lang="en-US">Return</span>
            <span lang="zh-CN">返回</span>
            <span lang="zh-TW">返回</span>
        </a></p>
    </div>


</main>

<script src="docs/jquery-3.5.1.slim.min.js"></script>
<script>
    $(document).ready(function() {
        var iframe = $('#script-iframe');

        $('#copy-script-button').show().click(function() {
            $('#script-container > textarea:visible').focus().select();
            document.execCommand('copy');
            var copiedNote = $('#copied-note').show();
            setTimeout(function() {
                copiedNote.hide();
            }, 1000);
        });

        $('.dropdown-toggle').on('focus blur', function(e) {
            var menu = $(this).siblings('.dropdown-menu');
            if (e.type === 'focus') {
                menu.show();
            } else {
                setTimeout(function() { menu.hide(); }, 200);
            }
        });

        var localizedTitles = {
            'en-US': 'Grafana Snapshot Export/Import Guide',
            'zh-CN': 'Grafana Snapshot 导出导入指南',
            'zh-TW': 'Grafana Snapshot 匯出匯入指南',
        };

        $('#lang-selector').prop('disabled', false).change(function() {
            var rules = document.styleSheets[1].cssRules;
            for (var i = 0; i < rules.length; i++) {
                var rule = rules[i];
                var st = rule.selectorText;
                if (st) {
                    rule.selectorText = st.replace(/\[lang=[^\]]+\]/, '[lang='+this.value+']');
                }
            }
            document.title = localizedTitles[this.value];
        }).change();

        $('#import-buttons > button').click(function() {
            $('.import-script').hide();
            $('#' + $(this).data('target')).show();
        });
    });
</script>
</body>
</html>
